this is chapter 3. some changes too